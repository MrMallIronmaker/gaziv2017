---
title: "Reproduction of Results by Gaziv, Noy, Liron, and Alon (2017, PLoS ONE)"
author: "Mark Miller (mrmillr@stanford.edu)"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  html_document:
    toc: yes
    toc_depth: 3
    toc_float:
      collapsed: false
bibliography: bibliography.bib
---

<!-- Replication reports should all use this template to standardize reporting across projects.  These reports will be public supplementary materials that accompany the summary report(s) of the aggregate results. -->

##Introduction

###Summary and Motivation

This paper studies *nonverbal synchrony*, the natural coordination of body movement between interacting individuals. Nonverbal synchrony is defined as a dynamic quality of movement, measured objectively and automatically, including both simultaneous movement and movement in a short time-lagged window [@Ramseyer2011]. To put it poetically, it is the individual words of body language. 
Early studies (1970s-1990s) were limited by quality or quantity of data. Individual body motions were collected by human coders, proving expensive in time or money. In contrast, in order to collect data on many subjects, the analysis was computational, and computers only measured motion holistically. 
Virtual reality tracking and today's devices like the Microsoft Kinect can collect nonverbal data with both quality and quantity. The challenge to current research, then, is finding, validating, and motivating methods with which to analyze the data. 
I plan to use a measure of synchrony in future studies, and so both developing the code to complete a data analysis pipeline and understanding the space and dangers in some of the analyses would be helpful to my future work.

###Procedure and Challenges

The data pipeline I will replicate mirrors the analysis given in the paper:

1. Smooth and clean the Kinect tracking data. This involves dropping frames and body parts that were not tracked in some frames, and smoothing the remaining data.
2. Convert position data to the more theoretically and perceptually salient velocity data.
3. Analyze the joint velocities using principal component analysis (PCA), and verifying their size relative to shuffled data as a control.
4. Use the PCA basis to determine whether a segment is a still, solo, or co-active motion segment.
5. Considering only the co-active motion segments, run PCA again to find the common co-active motion modes.
6. Calculate motion motifs by comparing against a time-rotated control dataset.

The results to replicate include:

1. Torso motion is the strongest component in PCA, accounting for 57%-95% of variance
2. Arm motion is the second strongest component, but it is much weaker.
3. Parallel-synchronized torso motion and mutual stillness are the two motion motifs.
4. Dyads show individuality in their mode distributions, i.e, the same dyad at different times or in different tasks show distributions more similar than different dyads in the same distribution.

The challenges will be both methodological and technical. The method as written appears to be unclear or underspecified at points. This is compounded by the complexity of the analysis. When two results do not match up, it may be an error from method, reporting, understanding, or programming - and if that data analysis had multiple steps before reaching a verifiable value, then a problem can exist in any or all of those steps.

### Links

- [Repository](https://github.com/MrMallIronmaker/gaziv2017)
- [Original Paper](https://github.com/MrMallIronmaker/gaziv2017/blob/master/original_paper/journal.pone.0170786.pdf)

##Methods

The data in question does not need to be collected, because this is a project of reproduction not replication. The data is available at the [Dryad digital repository](https://datadryad.org/resource/doi:10.5061/dryad.804j3).


## Results

### Data Preparation

Because this is a reproducability study, it is important to be precise in the formalization of the data analysis. Therefore, precise mathematial notation is appropriate. Through this process, areas of the paper that are unclear are discovered. Within these areas, assumptions are made explicit rather than left to interpretation. Though mathematical notation can be very _precise_, it can often be _unclear_. Care will be taken to ensure the mathematics given is both precise and clear.

### Defining the Raw Data
Define $J$ as the set of joints tracked by the Kinect - e.g, head, torso, shoulders, arms, hands, hips, and feet, and define $J_{U}$ as the joints in the upper body.

We define the raw Kinect data as a function $X_{raw}:J\times\mathbb{Z}\rightarrow\mathbb{R}^{3}$ that maps a joint at a particular frame to its position in 3D space. Intuitively, this means each joint and frame in the recording has a 3D point associated with it.

### Smoothing
The first filter applied is based upon the paper text:

> To smooth the data we removed position points which deviate discontinuously from their neighbors using a filter that removes the extreme points in a 5-timepoint window before averaging the remaining points.

This is formalized with the mathematical function

$$X_{firstFilter}(j,f)=\frac{\sum_{x\in nearby(X_{raw},j,f)}x-\min nearby(X_{raw},j,f)-\max nearby(X_{raw},j,f)}{3}$$
 

where $nearby(X,j,f)=\{X(j,f)|i\in\mathbb{Z},f-2\leq i\leq f+2\}$
 
Note that it is ambiguous whether both the maximum and minimum points are taken out, or only one. The paper does not specify the method for choosing which point (min or max) to take out, so I presume both the maximum and minimum are removed. It is also ambiguous what happens if two entries have the same maximum or minimum value. I have made the decision that exactly one is removed, not both. In addition, it is unclear what happens to points that do not have two neighbors in both directions, i.e, the beginning and end. I presume the data is thrown out.

The second filtering step is choosing the median in a five-step window three times.

$$X_{firstMedian}(j,f)=median(nearby(X_{firstFilter},j,f))$$
$$X_{secondMedian}(j,f)=median(nearby(X_{firstMedian},j,f))$$
$$X_{smoothed}(j,f)=X_{thirdMedian}(j,f)=median(nearby(X_{secondMedian},j,f))$$
Again, it is unclear what happens to points that do not have its nearby neighbors, and so I presume the data is thrown out.

Once the data was smoothed, discrete differentiation was performed between steps, 
$$V(j,f)=FPS\cdot(X_{smoothed}(j,f+1)-X_{smoothed}(j,f))$$
where FPS is the number of frames per second, i.e, 30. Note that the values of $V(j,f)$ are 3D vectors. 

### PCA Analysis
To perform PCA among the joints, rather than among the three dimensions for each joint, we collapse the velocity vector to a speed value.
This is done with a traditional Euclidean norm $S(j,f)=\|V(j,f)\|$.
These speed vectors are then normalized per joint to a mean of zero and standard deviation of one, i.e:
$$S_{normalized}(j,f)=\frac{S(j,f)-\mu(S_{all}(j))}{\sigma(S_{all}(j))}$$
where $S_{all}(j)=\{S(j,i)|0\leq i<f_{max}\}$. Note that in order to do this, some value for $f_{max}$ should be specified. No particular cutoff time is given, so I assume it will be for all available frames of data.

In performing PCA, we specify the vector to be the list of speeds of each upper-body joint at a given frame, i.e:

$$S_{PCA}(f)=\begin{bmatrix}S_{normalized}(\mbox{head},f)\\
S_{normalized}(\mbox{neck},f)\\
S_{normalized}(\mbox{left shoulder},f)\\
\vdots\\
S_{normalized}(\mbox{right hip},f)
\end{bmatrix}$$

The resulting set of vectors, $\{S_{PCA}(f),0\leq f<f_{max}\}$, is the subject of PCA analysis.

### Confirmatory analysis

**Hypothesis 1**: The first principal component will explain between 57% and 95% of variance of the data, and there will be strong loadings on all joints.

**Hypothesis 2**: The second principal component will have strong loadings on the arms for most participants.

###Exploratory analyses

Any follow-up analyses desired (not required).  

## Discussion

### Summary of Replication Attempt

Open the discussion section with a paragraph summarizing the primary result from the confirmatory analysis and the assessment of whether it replicated, partially replicated, or failed to replicate the original result.  

### Commentary

Add open-ended commentary (if any) reflecting (a) insights from follow-up exploratory analysis, (b) assessment of the meaning of the replication (or not) - e.g., for a failure to replicate, are the differences between original and present study ones that definitely, plausibly, or are unlikely to have been moderators of the result, and (c) discussion of any objections or challenges raised by the current and original authors about the replication attempt.  None of these need to be long.

## References
